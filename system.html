<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>PÄŒR | CENTRÃLNÃ SYSTÃ‰M</title>
    <style>
        body { display: flex; height: 100vh; overflow: hidden; padding: 0; margin: 0; background: #0b0f19; }
        
        /* LEVÃ SIDEBAR (MENU) */
        .sidebar { width: 260px; background: #161c2d; border-right: 1px solid #30363d; display: flex; flex-direction: column; padding: 20px 10px; overflow-y: auto; }
        .sidebar h2 { color: #0055a4; text-align: center; font-size: 18px; margin-bottom: 20px; letter-spacing: 1px; }
        .menu-btn { 
            background: transparent; color: #8b949e; border: none; padding: 12px 15px; 
            text-align: left; cursor: pointer; border-radius: 6px; margin-bottom: 5px; font-weight: 500; display: flex; align-items: center; 
        }
        .menu-btn:hover { background: #1f2937; color: white; }
        .menu-btn.active { background: #0055a4; color: white; }
        .menu-icon { margin-right: 10px; width: 20px; text-align: center; }

        /* HLAVNÃ OBSAH VPRAVO */
        .main-content { flex: 1; padding: 30px; overflow-y: auto; position: relative; }
        .section { display: none; } /* VÅ¡echny sekce skrytÃ© */
        .section.active { display: block; animation: fadeIn 0.3s; }

        /* MODULY STYLY */
        .header-bar { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #30363d; padding-bottom: 15px; margin-bottom: 20px; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .data-card { background: #0d1117; border: 1px solid #30363d; padding: 15px; border-radius: 6px; }
        .status-tag { padding: 3px 8px; border-radius: 4px; font-size: 11px; text-transform: uppercase; font-weight: bold; }
        .tag-green { background: #1b4b36; color: #4ade80; }
        .tag-red { background: #4b1b1b; color: #ff8888; }
        
        /* ALERT SCREEN (KdyÅ¾ vlezeÅ¡ kam nemÃ¡Å¡) */
        .alert-overlay {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #3d0000; color: #ffcccc; padding: 50px; box-sizing: border-box; z-index: 999;
        }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>POLICIE ÄŒR</h2>
        
        <button onclick="switchTab('dashboard')" class="menu-btn active"><span class="menu-icon">ğŸ </span> PÅ™ehled</button>
        <button onclick="switchTab('dispecink')" class="menu-btn"><span class="menu-icon">ğŸ“¡</span> OperaÄnÃ­ (LUNA)</button>
        
        <div style="height: 1px; background: #30363d; margin: 10px 0;"></div>
        <div style="font-size: 11px; color: #666; padding-left: 10px; margin-bottom: 5px;">AGENDA</div>

        <button onclick="checkCriminalAccess()" class="menu-btn"><span class="menu-icon">ğŸ“‚</span> VyÅ¡etÅ™ovacÃ­ spisy</button>
        <button onclick="switchTab('warrants')" class="menu-btn"><span class="menu-icon">âš–ï¸</span> ZatykaÄe</button>
        <button onclick="switchTab('evidence')" class="menu-btn"><span class="menu-icon">ğŸ“¦</span> Sklad dÅ¯kazÅ¯</button>
        <button onclick="switchTab('cars')" class="menu-btn"><span class="menu-icon">ğŸš“</span> VozovÃ½ park</button>
        <button onclick="switchTab('weapons')" class="menu-btn"><span class="menu-icon">ğŸ”«</span> ZbrojnÃ­ sklad</button>
        
        <div style="height: 1px; background: #30363d; margin: 10px 0;"></div>
        <div style="font-size: 11px; color: #666; padding-left: 10px; margin-bottom: 5px;">ADMINISTRATIVA</div>

        <button onclick="switchTab('bulletin')" class="menu-btn"><span class="menu-icon">ğŸ“¢</span> InformaÄnÃ­ deska</button>
        <button onclick="switchTab('academy')" class="menu-btn"><span class="menu-icon">ğŸ“</span> Akademie</button>
        <button onclick="switchTab('hr')" class="menu-btn"><span class="menu-icon">ğŸ–ï¸</span> PersonÃ¡lnÃ­</button>
        <button onclick="switchTab('ovk')" class="menu-btn"><span class="menu-icon">ğŸ•µï¸</span> VnitÅ™nÃ­ kontrola</button>
        
        <div style="margin-top: auto;">
            <button onclick="logout()" class="menu-btn" style="color: #ff6666;"><span class="menu-icon">ğŸšª</span> OdhlÃ¡sit se</button>
        </div>
    </div>

    <div class="main-content">
        
        <div id="tab-dashboard" class="section active">
            <div class="header-bar">
                <h1>VÃ­tejte v systÃ©mu, <span id="userName">...</span></h1>
                <span id="userOE" style="color: #8b949e;">OEÄŒ: ...</span>
            </div>
            <div class="card-grid">
                <div class="data-card" onclick="switchTab('bulletin')" style="cursor:pointer; border-left: 4px solid #0055a4;">
                    <h3>ğŸ“¢ PoslednÃ­ oznÃ¡menÃ­</h3>
                    <p style="font-size:13px; color:#aaa;">KliknÄ›te pro zobrazenÃ­ smÄ›rnic a rozkazÅ¯.</p>
                </div>
                <div class="data-card" onclick="switchTab('dispecink')" style="cursor:pointer; border-left: 4px solid #00ff88;">
                    <h3>ğŸ“¡ MÅ¯j Status</h3>
                    <div id="dashboardStatus">NaÄÃ­tÃ¡m...</div>
                </div>
            </div>
        </div>

        <div id="tab-kriminalka" class="section">
            <div class="header-bar">
                <h2>ğŸ“‚ VyÅ¡etÅ™ovacÃ­ spisy (SKPV)</h2>
                <button class="menu-btn" style="width:auto; background:#238636; color:white;">+ NOVÃ SPIS</button>
            </div>
            <div id="criminalList" class="card-grid">
                <p>NaÄÃ­tÃ¡m tajnÃ© spisy...</p>
            </div>
        </div>

        <div id="tab-warrants" class="section">
            <div class="header-bar">
                <h2>âš–ï¸ AktivnÃ­ zatykaÄe</h2>
                <button class="menu-btn" style="width:auto; background:#a40e26; color:white;">+ VYDAT ZATYKAÄŒ</button>
            </div>
            <div id="warrantsList">
                <div class="data-card">
                    <div style="display:flex; justify-content:space-between;">
                        <strong>HledanÃ½: John Doe</strong>
                        <span class="status-tag tag-red">AKTIVNÃ</span>
                    </div>
                    <p>DÅ¯vod: OzbrojenÃ¡ loupeÅ¾. Soudce: JUDr. NovÃ¡k</p>
                </div>
            </div>
        </div>

        <div id="tab-dispecink" class="section">
            <div class="header-bar">
                <h2>ğŸ“¡ OperaÄnÃ­ stÅ™edisko LUNA</h2>
            </div>
            <iframe src="dispecink.html" style="width:100%; height:80vh; border:none;"></iframe>
        </div>

        <div id="tab-evidence" class="section"><h2>ğŸ“¦ Sklad dÅ¯kazÅ¯</h2><p>Evidence doliÄnÃ½ch pÅ™edmÄ›tÅ¯...</p></div>
        <div id="tab-cars" class="section"><h2>ğŸš“ VozovÃ½ park</h2><p>SprÃ¡va sluÅ¾ebnÃ­ch vozidel...</p></div>
        <div id="tab-weapons" class="section"><h2>ğŸ”« ZbrojnÃ­ sklad</h2><p>VÃ½dej a pÅ™Ã­jem zbranÃ­...</p></div>
        <div id="tab-bulletin" class="section"><h2>ğŸ“¢ InformaÄnÃ­ deska</h2><p>SmÄ›rnice a naÅ™Ã­zenÃ­...</p></div>
        <div id="tab-academy" class="section"><h2>ğŸ“ PolicejnÃ­ Akademie</h2><p>VÃ½cvikovÃ© protokoly...</p></div>
        <div id="tab-hr" class="section"><h2>ğŸ–ï¸ PersonÃ¡lnÃ­ oddÄ›lenÃ­</h2><p>SloÅ¾ky pÅ™Ã­sluÅ¡nÃ­kÅ¯...</p></div>
        <div id="tab-ovk" class="section"><h2>ğŸ•µï¸ VnitÅ™nÃ­ kontrola</h2><p>PÅ™Ã­stup pouze pro inspekci.</p></div>

        <div id="accessDeniedOverlay" class="alert-overlay">
            <h1 style="color:red; border-bottom:2px solid red; padding-bottom:10px;">â›” NEOPRÃVNÄšNÃ PÅ˜ÃSTUP â›”</h1>
            <p style="font-size:18px;"><strong>VAROVÃNÃ BEZPEÄŒNOSTNÃHO SYSTÃ‰MU</strong></p>
            <p>PokouÅ¡Ã­te se vstoupit do databÃ¡ze <strong>SluÅ¾by kriminÃ¡lnÃ­ policie a vyÅ¡etÅ™ovÃ¡nÃ­ (SKPV)</strong> bez patÅ™iÄnÃ© bezpeÄnostnÃ­ provÄ›rky.</p>
            <br>
            <p style="font-family:'Courier New';">
                DETEKCE UÅ½IVATELE: <span id="intruderName"></span><br>
                IP ADRESA: LOGGED<br>
                STATUS: ODESÃLÃNÃ HLÃÅ ENÃ NA OVK...
            </p>
            <br>
            <p style="color:#ff8888; font-size:14px;">
                TÃ­mto jednÃ¡nÃ­m jste naplnil skutkovou podstatu trestnÃ©ho Äinu dle <strong>Â§ 230 TZ</strong> (NeoprÃ¡vnÄ›nÃ½ pÅ™Ã­stup k poÄÃ­taÄovÃ©mu systÃ©mu). VaÅ¡e aktivita byla zaznamenÃ¡na. OkamÅ¾itÄ› opusÅ¥te tento prostor.
            </p>
            <button onclick="closeAlert()" style="background:#550000; color:white; padding:15px; border:1px solid red; margin-top:30px; cursor:pointer;">ROZUMÃM A ODCHÃZÃM</button>
        </div>

    </div>

    <script>
        const user = JSON.parse(localStorage.getItem('pcr_user'));
        if (!user) window.location.href = 'index.html';

        document.getElementById('userName').innerText = user.username;
        document.getElementById('userOE').innerText = 'OEÄŒ: ' + (user.oec || 'N/A');
        document.getElementById('intruderName').innerText = user.username.toUpperCase();

        function switchTab(tabId) {
            // Skryje vÅ¡echny sekce
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.menu-btn').forEach(el => el.classList.remove('active'));
            
            // ZobrazÃ­ vybranou
            document.getElementById('tab-' + tabId).classList.add('active');
            
            // Highlight tlaÄÃ­tka (najdeme podle onclicku, trochu prasÃ¡rna ale funkÄnÃ­)
            const btns = document.querySelectorAll('.menu-btn');
            btns.forEach(b => {
                if(b.getAttribute('onclick').includes(tabId)) b.classList.add('active');
            });
        }

        // === KONTROLA PÅ˜ÃSTUPU NA KRIMINÃLKU ===
        function checkCriminalAccess() {
            // Role, kterÃ© tam mÅ¯Å¾ou (pÅ™idej sem pÅ™esnÃ© nÃ¡zvy z DB)
            const allowed = ['KriminÃ¡lnÃ­ policie', 'GenerÃ¡lporuÄÃ­k', 'GenerÃ¡lmajor', 'VedenÃ­ PÄŒR'];
            
            // MÃ¡ uÅ¾ivatel nÄ›jakou z povolenÃ½ch rolÃ­?
            const hasAccess = user.roles.some(r => allowed.includes(r));

            if (hasAccess) {
                switchTab('kriminalka');
                loadCriminalCases(); // NaÄte data z DB (musÃ­me dodÄ›lat backend)
            } else {
                // PUSTÃ TO NA NÄšJ TU HRÅ®ZU
                document.getElementById('accessDeniedOverlay').style.display = 'block';
                // PÅ™ehrÃ¡t zvuk sirÃ©ny? MoÅ¾nÃ¡ pÅ™Ã­Å¡tÄ› :D
            }
        }

        function closeAlert() {
            document.getElementById('accessDeniedOverlay').style.display = 'none';
            switchTab('dashboard'); // Kopne ho zpÃ¡tky na Ãºvod
        }

        function logout() { localStorage.removeItem('pcr_user'); window.location.href = 'index.html'; }

        // Placeholder funkce pro naÄÃ­tÃ¡nÃ­ dat
        async function loadCriminalCases() {
            const list = document.getElementById('criminalList');
            // Tady by byl fetch na API
            list.innerHTML = '<div class="data-card"><h3>Spis Ä. 2024/001 - VraÅ¾da v Sandy Shores</h3><p>Stav: OtevÅ™eno | VyÅ¡etÅ™uje: kpt. NovÃ¡k</p></div>';
        }

    </script>
</body>
</html>
